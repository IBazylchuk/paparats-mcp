{
  "codingInstructions": "Semantic code search and knowledge base across workspace projects.\n\nMANDATORY: You MUST call search_code BEFORE answering ANY question about the codebase. This includes questions about: \"how does X work\", \"where is X\", \"find X\", \"what does X do\", \"how many X\", \"list X\", \"count X\", \"which files\", \"show me X\", \"is there a X\", implementation details, patterns, flows, or any reference to project code.\n\nDo NOT answer from memory or guess. Do NOT use grep or file reading as first resort — search_code is more efficient (50-90% fewer tokens vs full files).\n\nWorkflow: search_code FIRST → evaluate scores → get_chunk for details → find_usages for dependencies → answer with citations.\n\nScore interpretation (included with each result):\n- 60%+ = high confidence — trust these results\n- 40-59% = partial match — supplement with grep or file reading\n- <40% = low confidence — fall back to grep, file reading, or ask the user\n\nUse reindex when files are added/changed and search results seem stale. Use health_check to verify indexing status.",
  "supportInstructions": "Semantic code search and knowledge base across workspace projects.\n\nThis tool is used by support team members who have no direct code access.\nAlways explain results in plain language, not just code snippets.\nAlways include: which service, last changed (date + author), linked tickets.\nNever tell the user to 'check the file' or 'run grep' — they cannot.\n\nDecision tree — pick the right tool for the question:\n- 'How does X work?' → explain_feature(X)\n- 'When was X changed / who changed it?' → recent_changes(X)\n- 'What breaks if I change X?' / 'What else is affected?' → impact_analysis(X)\n- 'Show me the code for X' → search_code(X) → get_chunk(chunk_id)\n- 'Where is X used?' / 'What calls X?' → search_code(X) → find_usages(chunk_id)\n- 'Find recent changes to X' → search_changes(query, since)\nMANDATORY: You MUST call search_code BEFORE answering code questions UNLESS a high-level tool (explain_feature, recent_changes, impact_analysis) is more appropriate.\n\nScore interpretation (included with each result):\n- 60%+ = high confidence — trust these results\n- 40-59% = partial match — try rephrasing or narrowing the query\n- <40% = low confidence — ask the user for more specific terms\n\nWhen answering, always include:\n1. What the feature does (1-2 sentences, plain language)\n2. Which service/file owns it (from payload: service, file_path)\n3. Last changed: date, author, ticket (from get_chunk_meta or recent_changes)\n4. Where it's used (from find_usages, if relevant)\nFormat ticket keys as references: [JR-1234], [GH-567].\n\nIf search returns no results or all scores are below 40%, respond: 'I could not find relevant code for this question. Try rephrasing or provide more specific terms (service name, function name, ticket number).'",
  "common": {
    "searchFirst": "MANDATORY: Always call search_code BEFORE answering any code question. Never guess or answer from memory.",
    "noResults": "If search returns no results or all scores are below 40%: try grep or file reading if available. Otherwise respond: 'I could not find relevant code for this question. Try rephrasing or provide more specific terms (service name, function name, ticket number).'"
  },
  "tools": {
    "search_code": {
      "description": "REQUIRED — call this FIRST for ANY code question.\n\nSemantic code search across all indexed projects. Returns relevant code chunks ranked by confidence score with symbol definitions and usages.\n\nTriggers (call this when the user asks about): code location, implementation, \"how X works\", \"how many X\", \"what versions of X\", \"count X\", \"list X\", patterns, flows, error handling, auth, API usage, or ANY reference to project code.\n\nWHY: Returns only relevant chunks (50-90% fewer tokens vs full files). Searches by meaning, not just keywords.\n\nWORKFLOW: Search first → evaluate scores → get_chunk for details → find_usages for dependencies."
    },
    "health_check": {
      "description": "Check indexing status: number of indexed chunks per group and any running reindex jobs.\n\nUse to verify projects are indexed before searching or debugging empty results."
    },
    "reindex": {
      "description": "Trigger full reindex of a group or all groups. Runs in background.\n\nReturns job ID to track progress via health_check. Use after adding new files or changing project config."
    },
    "get_chunk": {
      "description": "Get a code chunk by ID with optional surrounding context. Returns code with symbol definitions and usage info. Use to expand on search results."
    },
    "get_chunk_meta": {
      "description": "Get git history and ticket references for a code chunk. Returns commits, authors, dates, and linked tickets. No code — use get_chunk for code."
    },
    "search_changes": {
      "description": "Search code modified after a date. Same as search_code but filtered by last commit time. Each result shows when it was last changed. The since parameter accepts ISO 8601 date (e.g. '2026-01-01') or relative strings like '7 days ago', '1 month ago'."
    },
    "find_usages": {
      "description": "Find symbol relationships: what calls this code, and what this code calls. Supports incoming (callers), outgoing (dependencies), or both directions. Use after search_code or get_chunk when the user asks 'where is this used?', 'what calls this?', or 'what does this depend on?'. Pass chunk_id from search results."
    },
    "explain_feature": {
      "description": "Comprehensive feature analysis in one call. Returns code locations, recent changes, and related modules for a question — no code content. Use as the first tool when the user asks 'how does X work?'. Use get_chunk to drill into specific chunks afterward."
    },
    "recent_changes": {
      "description": "Timeline of recent changes matching a query. Returns commits grouped by date with affected files and tickets — no code content. Supports date filtering via since parameter (ISO 8601 or relative like '7 days ago'). Use as the first tool when the user asks 'when was X changed?' or 'who changed X?'."
    },
    "impact_analysis": {
      "description": "Shows what other services and modules depend on a given feature. Use when the user asks 'what else could be affected?', 'which teams own related code?', or 'what breaks if I change X?'. Returns dependency graph grouped by service — no code content."
    }
  },
  "resources": {
    "projectOverview": {
      "searchCapabilitiesTitle": "## Search Capabilities",
      "searchCapabilitiesBody": "MANDATORY: Use search_code tool FIRST for ANY code question. This is MORE EFFICIENT than loading full files (50-90% fewer tokens). Do not guess or answer from memory — always search first.",
      "exampleQueries": [
        "\"authentication flow\"",
        "\"GraphQL mutations for user\"",
        "\"error handling patterns\"",
        "\"AWS infrastructure setup\""
      ],
      "scoreInterpretation": "Each search result includes a confidence score. 60%+ means high confidence (trust the result). 40-59% means partial match (supplement with grep or file reading if available, or try rephrasing). Below 40% means low confidence (fall back to grep/file reading, rephrase, or ask the user for more specific terms).",
      "searchFirstNote": "MANDATORY: Always call search_code BEFORE answering any code question. Never guess or answer from memory."
    }
  }
}
